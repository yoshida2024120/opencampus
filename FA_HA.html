<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>全加算器と半加算器（Cin = ha_carry）</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; }
    canvas { border: 1px solid #ccc; background: white; }
    button { margin: 5px; padding: 10px 20px; font-size: 16px; }
  </style>
</head>
<body>

<h1>全加算器と半加算器（Cin = ha_carry）</h1>
<canvas id="adderCanvas" width="900" height="800"></canvas>
<br>
<button id="btnA">入力A2: OFF</button>
<button id="btnHAA">入力A1: OFF</button>
<button id="btnB">入力B2: OFF</button>
<button id="btnHAB">入力B1: OFF</button>

<script>
  let inputA = false;
  let inputB = false;
  let inputHAA = false;
  let inputHAB = false;

  document.getElementById("btnA").onclick = function() {
    inputA = !inputA;
    updateButtonLabels();
    drawAdder();
  };

  document.getElementById("btnHAA").onclick = function() {
    inputHAA = !inputHAA;
    updateButtonLabels();
    drawAdder();
  };

  document.getElementById("btnB").onclick = function() {
    inputB = !inputB;
    updateButtonLabels();
    drawAdder();
  };

  document.getElementById("btnHAB").onclick = function() {
    inputHAB = !inputHAB;
    updateButtonLabels();
    drawAdder();
  };

  function updateButtonLabels() {
    document.getElementById("btnA").textContent = "入力A2: " + (inputA ? "1" : "0");
    document.getElementById("btnHAA").textContent = "入力A1: " + (inputHAA ? "1" : "0");
    document.getElementById("btnB").textContent = "入力B2: " + (inputB ? "1" : "0");
    document.getElementById("btnHAB").textContent = "入力B1: " + (inputHAB ? "1" : "0ß");
  }

  function drawAdder() {
    const canvas = document.getElementById("adderCanvas");
    const ctx = canvas.getContext("2d");
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    const onColor = "red";
    const offColor = "gray";
    const lw = 10;

    const ha_sum = inputHAA ^ inputHAB;
    const ha_carry = inputHAA && inputHAB;

    const cin = ha_carry;
    const fa_sum = inputA ^ inputB ^ cin;
    const fa_carry = (inputA && inputB) || (inputA && cin) || (inputB && cin);

    const FAy = 170;
 

    // === 全加算器の入力線 ===
    ctx.lineWidth = lw;
    ctx.strokeStyle = inputA ? onColor : offColor;
    ctx.beginPath(); ctx.moveTo(150, 335.5); ctx.lineTo(300, 335.5); ctx.stroke();
    ctx.fillStyle = inputA ? onColor : offColor;
    ctx.font = "40px Arial";
    ctx.fillText(inputA ? "1" : "0", 110, 348);

    ctx.lineWidth = lw;
    ctx.strokeStyle = inputB ? onColor : offColor;
    ctx.beginPath(); ctx.moveTo(245, 363.5); ctx.lineTo(303, 363.5); ctx.stroke();
    ctx.beginPath(); ctx.moveTo(150, 500.5); ctx.lineTo(250, 360.5); ctx.stroke();
    
    ctx.fillStyle = inputB ? onColor : offColor;
    ctx.fillText(inputB ? "1" : "0", 110, 518);

    ctx.lineWidth = lw;
    ctx.strokeStyle = cin ? onColor : offColor;
    ctx.beginPath(); ctx.moveTo(260, 270.5+120); ctx.lineTo(300, 270.5+120); ctx.stroke(); 
    // 全加算器のCの最後の横線
    ctx.beginPath(); ctx.moveTo(260, 265+120); ctx.lineTo(260, 325+120.5); ctx.stroke();
    // 全加算器のCの縦線
    ctx.beginPath(); ctx.moveTo(260, 320.5+120); ctx.lineTo(475, 320.5+120); ctx.stroke();
    // 全加算器のCの横線
    ctx.beginPath(); ctx.moveTo(470, 318.5+120); ctx.lineTo(470, 505.5); ctx.stroke();
    // 半加算器の上の出力からCへ行くの縦線
    
    
    ctx.fillStyle = cin ? onColor : offColor;
    //ctx.fillText(cin ? "1" : "0", 110, 518);

    // FA 本体
    ctx.strokeStyle = "black";
    ctx.lineWidth = 5;
    ctx.strokeRect(300, 140+170, 100, 100);
    ctx.fillStyle = "black";
    ctx.font = "20px Arial";
    ctx.fillText("FA", 330, 360);

    // 全加算器の出力線
    ctx.lineWidth = lw;
    ctx.strokeStyle = fa_sum ? onColor : offColor;
    ctx.beginPath(); ctx.moveTo(400, 220.5+FAy); ctx.lineTo(550, 220.5+FAy); ctx.stroke();
    ctx.fillStyle = "black"; //ctx.fillText("1桁目", 580, 270);
    ctx.fillStyle = fa_sum ? onColor : offColor;
    ctx.font = "40px Arial";
    ctx.fillText(fa_sum ? "1" : "0", 560, 400);

    ctx.lineWidth = lw;
    ctx.strokeStyle = fa_carry ? onColor : offColor;
    ctx.beginPath(); ctx.moveTo(400, 160.5+FAy); ctx.lineTo(550, 160.5+FAy); ctx.stroke();
    ctx.fillStyle = "black";// ctx.fillText("2桁目", 580, 150);
    ctx.fillStyle = fa_carry ? onColor : offColor;
    ctx.fillText(fa_carry ? "1" : "0", 560, 340);

    ctx.fillStyle = "black";
    ctx.font = "40px Arial";
//    ctx.fillText("全加算器: ", 150, 360);
    ctx.fillStyle = inputA ? onColor : offColor;
//    ctx.fillText(inputA ? "1" : "0", 320, 360);
//    ctx.fillStyle = "black"; ctx.fillText("+", 355, 360);
    ctx.fillStyle = inputB ? onColor : offColor;
//    ctx.fillText(inputB ? "1" : "0", 390, 360);
//    ctx.fillText("+", 425, 360);
    ctx.fillStyle = cin ? onColor : offColor;
//    ctx.fillText(cin ? "1" : "0", 460, 360);
//    ctx.fillStyle = "black"; ctx.fillText("=", 495, 360);
    ctx.fillStyle = fa_carry ? onColor : offColor;
//    ctx.fillText(fa_carry ? "1" : "0", 530, 360);
    ctx.fillStyle = fa_sum ? onColor : offColor;
//    ctx.fillText(fa_sum ? "1" : "0", 570, 360);

    // === 半加算器の入力線 ===
    ctx.lineWidth = lw;
    ctx.strokeStyle = inputHAA ? onColor : offColor;
    ctx.beginPath(); ctx.moveTo(250, 500.5); ctx.lineTo(300, 500.5); ctx.stroke();
    ctx.beginPath(); ctx.moveTo(150, 370.5); ctx.lineTo(254.5, 503.5); ctx.stroke();
  
    ctx.fillStyle = inputHAA ? onColor : offColor;
    ctx.fillText(inputHAA ? "1" : "0", 110, 395);

    ctx.lineWidth = lw;
    ctx.strokeStyle = inputHAB ? onColor : offColor;
    ctx.beginPath(); ctx.moveTo(150, 560.5); ctx.lineTo(300, 560.5); ctx.stroke();
    ctx.fillStyle = inputHAB ? onColor : offColor;
    ctx.fillText(inputHAB ? "1" : "0", 110, 568);

    // HA 本体
    ctx.strokeStyle = "black";
    ctx.lineWidth = 5;
    ctx.strokeRect(300, 480, 100, 100);
    ctx.fillStyle = "black";
    ctx.font = "20px Arial";
    ctx.fillText("HA", 330, 540);

    // 半加算器の出力線
    ctx.lineWidth = lw;
    ctx.strokeStyle = ha_sum ? onColor : offColor;
    ctx.beginPath(); ctx.moveTo(400, 560.5); ctx.lineTo(550, 560.5); ctx.stroke();
    ctx.fillStyle = "black"; //ctx.fillText("1桁目", 580, 560);
    ctx.fillStyle = ha_sum ? onColor : offColor;
    ctx.font = "40px Arial";
    ctx.fillText(ha_sum ? "1" : "0", 560, 570);

    ctx.lineWidth = lw;
    ctx.strokeStyle = ha_carry ? onColor : offColor;
    ctx.beginPath(); ctx.moveTo(400, 500.5); ctx.lineTo(470, 500.5); ctx.stroke();
    ctx.fillStyle = "black"; //ctx.fillText("2桁目", 580, 500);
    ctx.fillStyle = ha_carry ? onColor : offColor;
   // ctx.fillText(ha_carry ? "1" : "0", 560, 510);

   // ctx.fillStyle = "black";
   // ctx.font = "40px Arial";
   // ctx.fillText("半加算器: ", 150, 680);
   // ctx.fillStyle = inputHAA ? onColor : offColor;
   // ctx.fillText(inputHAA ? "1" : "0", 320, 680);
   // ctx.fillStyle = "black"; ctx.fillText("+", 355, 680);
   // ctx.fillStyle = inputHAB ? onColor : offColor;
   // ctx.fillText(inputHAB ? "1" : "0", 390, 680);
   // ctx.fillStyle = "black"; ctx.fillText("=", 430, 680);
   // ctx.fillStyle = ha_carry ? onColor : offColor;
   // ctx.fillText(ha_carry ? "1" : "0", 470, 680);
   // ctx.fillStyle = ha_sum ? onColor : offColor;
   // ctx.fillText(ha_sum ? "1" : "0", 510, 680);

    let binary1 = (inputA ? 1 : 0)*2  + (inputHAA ? 1 : 0); 
    let binary2 = (inputB ? 1 : 0)*2  + (inputHAB ? 1 : 0); 
    let binary3 = binary1 + binary2; 

    let decimalStr1 = binary1.toString();        
    let decimalStr2 = binary2.toString();  
    let decimalStr3 = binary3.toString();  
          

// 描画
const x10 = 300
ctx.font = "40px Arial";
ctx.fillStyle = "black";
ctx.fillText("+", 680-x10, 680);
ctx.fillText("10進数:"+ decimalStr1, 210, 680);  // ← ← 座標をここで調整
ctx.fillText( decimalStr2, 730-x10, 680);  // ← ← 座標をここで調整
ctx.fillText("=", 800-x10, 680);
ctx.fillText( decimalStr3, 850-x10, 680);  // ← ← 座標をここで調整

ctx.fillText("+", 113, 455);
   
  }

  updateButtonLabels();
  drawAdder();
</script>

</body>
</html>
